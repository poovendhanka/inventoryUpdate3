<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      th:replace="~{layout/base :: html}">
<head>
    <title>Reports</title>
</head>
<body>
    <h1 id="pageTitle">Reports</h1>
    
    <div id="content">
        <!-- Report Tabs -->
        <ul class="nav nav-tabs mb-4">
            <li class="nav-item">
                <a class="nav-link" id="production-tab" 
                   th:classappend="${activeReportTab == 'production'} ? 'active' : ''"
                   href="#production-report" data-bs-toggle="tab">
                   <i class="fas fa-chart-line"></i> Production Report
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" id="cocopith-tab" 
                   th:classappend="${activeReportTab == 'cocopith'} ? 'active' : ''"
                   href="#cocopith-report" data-bs-toggle="tab">
                   <i class="fas fa-leaf"></i> Cocopith Report
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" id="block-tab" 
                   th:classappend="${activeReportTab == 'block'} ? 'active' : ''"
                   href="#block-report" data-bs-toggle="tab">
                   <i class="fas fa-cubes"></i> Block Report
                </a>
            </li>
        </ul>

        <!-- Tab Content -->
        <div class="tab-content">
            <!-- Production Report Tab -->
            <div class="tab-pane fade" id="production-report" 
                 th:classappend="${activeReportTab == 'production'} ? 'show active' : ''">
                <div class="card">
                    <div class="card-header">
                        <h5 class="card-title mb-0">Generate Production Report</h5>
                    </div>
                    <div class="card-body">
                        <form th:action="@{/production-report/view}" method="get">
                            <div class="row mb-3">
                                <div class="col-md-8">
                                    <label class="form-label">Select Date</label>
                                    <input type="date" class="form-control" id="productionReportDate" name="date" required>
                                </div>
                                <div class="col-md-4">
                                    <label class="form-label">&nbsp;</label>
                                    <button type="submit" class="btn btn-primary d-block w-100">Generate Report</button>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Cocopith Report Tab -->
            <div class="tab-pane fade" id="cocopith-report" 
                 th:classappend="${activeReportTab == 'cocopith'} ? 'show active' : ''">
                <div class="card">
                    <div class="card-header">
                        <h5 class="card-title mb-0">Generate Cocopith Production Report</h5>
                    </div>
                    <div class="card-body">
                        <form th:action="@{/cocopith-report/view}" method="get">
                            <div class="row mb-3">
                                <div class="col-md-5">
                                    <label class="form-label">Start Date</label>
                                    <input type="date" class="form-control" id="cocopithStartDate" name="startDate" required>
                                </div>
                                <div class="col-md-5">
                                    <label class="form-label">End Date</label>
                                    <input type="date" class="form-control" id="cocopithEndDate" name="endDate" required>
                                </div>
                                <div class="col-md-2">
                                    <label class="form-label">&nbsp;</label>
                                    <button type="submit" class="btn btn-primary d-block w-100">Generate Report</button>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Block Report Tab -->
            <div class="tab-pane fade" id="block-report" 
                 th:classappend="${activeReportTab == 'block'} ? 'show active' : ''">
                <div class="card">
                    <div class="card-header">
                        <h5 class="card-title mb-0">Generate Block Production Report</h5>
                    </div>
                    <div class="card-body">
                        <form th:action="@{/block-report/view}" method="get">
                            <div class="row mb-3">
                                <div class="col-md-5">
                                    <label class="form-label">Start Date</label>
                                    <input type="date" class="form-control" id="blockStartDate" name="startDate" required>
                                </div>
                                <div class="col-md-5">
                                    <label class="form-label">End Date</label>
                                    <input type="date" class="form-control" id="blockEndDate" name="endDate" required>
                                </div>
                                <div class="col-md-2">
                                    <label class="form-label">&nbsp;</label>
                                    <button type="submit" class="btn btn-primary d-block w-100">Generate Report</button>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <th:block id="pagescript">
        <script>
            $(document).ready(function() {
                // Initialize date fields
                
                // Production Report - Today's date
                $('#productionReportDate').val(new Date().toISOString().split('T')[0]);
                
                // Cocopith and Block Reports - Current month
                const today = new Date();
                const firstDay = new Date(today.getFullYear(), today.getMonth(), 1);
                const lastDay = new Date(today.getFullYear(), today.getMonth() + 1, 0);
                
                $('#cocopithStartDate, #blockStartDate').val(firstDay.toISOString().split('T')[0]);
                $('#cocopithEndDate, #blockEndDate').val(lastDay.toISOString().split('T')[0]);
                
                // Save active tab to sessionStorage when tab changes
                $('a[data-bs-toggle="tab"]').on('shown.bs.tab', function (e) {
                    const tabId = $(e.target).attr('id');
                    sessionStorage.setItem('lastReportTab', tabId);
                });
                
                // Restore last active tab if available
                const lastTab = sessionStorage.getItem('lastReportTab');
                if (lastTab && $('#' + lastTab).length) {
                    $('#' + lastTab).tab('show');
                }
            });
        </script>
    </th:block>
</body>
</html> 